# 生命周期
## 垃圾收集器
OX通过垃圾收集器进行内存管理。

垃圾收集器在OX虚拟机进行多次内存分配后启动垃圾收集过程。
垃圾收集过程中OX虚拟机会扫描并标记所有还在使用的内存。最后将没有标记的内存进行释放。
通过垃圾收集器，OX虚拟机会自动发现并释放不再使用的内存，不需要用户自己手动做内存释放。
## $close
垃圾收集的启动时机是OX虚拟机自己控制的，用户无法手动控制何时开始垃圾收集过程。
但在实际开发过程中，有时一些资源需要立即释放，用户可以通过"$close"方法定义资源释放操作。
比如文件对象，在创建时会自动分配并打开文件，当我们文件操作完成时，希望立即关闭文件，否则可能继续占用系统文件资源。
```
ref "std/io"

file = File("tmp.txt", "rb") //打开文件

do_file_operation(file) //文件操作

file.$close() //关闭文件
```
## 自动关闭
我们可以将变量声明为自动关闭型变量。这样当我们重设变量值，或退出变量所在的函数时，OX虚拟机会自动调用变量的"$close"方法释放变量中存储对象的资源。
```
ref "std/io"

#file = File("tmp.txt", "rb") //变量前加"#"，表示是一个自动关闭型变量。

do_file_operation(file) //文件操作

file = File("tmp2.txt", "rb") //重新设置变量file，因为file是自动关闭变量，先自动调用"file.$close()",再将file设置为新值

do_file_operation(file) //文件操作

//程序结束，先自动调用"file.$close()"
```